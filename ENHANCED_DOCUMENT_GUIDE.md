# Enhanced Document Processing ‚Äî Complete Usage Guide

**Created:** 2026-01-11
**Purpose:** Comprehensive guide for all document processing capabilities in Enigma
**Status:** Production Ready

---

## üéØ WHAT'S NEW

Enigma now has **comprehensive document processing capabilities** that can:

‚úÖ **Read** Word documents (.docx and .doc)  
‚úÖ **Grammar check** with detailed analysis  
‚úÖ **Proofread** documents using your Writing Standard  
‚úÖ **Generate PDFs** automatically  
‚úÖ **Create refined versions** with tracked changes  
‚úÖ **Full workflow automation** from start to finish  

---

## üöÄ QUICK START

### Process a Single Document (Recommended)
```bash
cd ~/Enigma
python3 scripts/enhanced_document_processor.py --file "03_Projects/Product_Genome/your_file.docx" --action full_edit
```

**What happens:**
1. Document is read and analyzed
2. Grammar and style issues are identified  
3. Proofread version is created
4. PDF is automatically generated
5. All outputs saved to `06_Derived/`

### Individual Actions
```bash
# Just check for issues (no changes made)
python3 scripts/enhanced_document_processor.py --file "path/to/file.docx" --action grammar_check

# Create proofread version only
python3 scripts/enhanced_document_processor.py --file "path/to/file.docx" --action proofread

# Generate PDF from existing Word doc
python3 scripts/enhanced_document_processor.py --file "path/to/file.docx" --action generate_pdf
```

---

## üìÅ FILE ORGANIZATION

### Input Files (Your Originals)
```
03_Projects/Product_Genome/
‚îú‚îÄ‚îÄ TPG_WorkingFile05012026.docx     ‚Üê Your working files
‚îú‚îÄ‚îÄ TPG_Book.doc                     ‚Üê Legacy formats  
‚îî‚îÄ‚îÄ Chapter_drafts/
    ‚îî‚îÄ‚îÄ *.docx                       ‚Üê Chapter files
```

### Output Files (Generated by Enigma)
```
06_Derived/
‚îú‚îÄ‚îÄ [filename]_PROOFREAD.docx        ‚Üê Edited Word documents
‚îú‚îÄ‚îÄ [filename]_PROOFREAD.pdf         ‚Üê PDF versions
‚îî‚îÄ‚îÄ [filename]_PDF_INSTRUCTIONS.txt  ‚Üê Manual PDF steps (if needed)
```

---

## üîç WHAT THE SYSTEM CHECKS

### Grammar Analysis
- **Subject-verb agreement errors**
- **Tense consistency issues** 
- **Punctuation problems** (missing commas, incorrect apostrophes)
- **Sentence fragments and run-ons**
- **Parallel construction in lists**

### Style Enforcement  
- **Buzzword elimination** (synergy, leverage, revolutionary, etc.)
- **Passive voice conversion** to active voice
- **Weak language replacement** (pretty good ‚Üí specific metrics)
- **Tone consistency** per your Writing Standard
- **Professional + Casual voice** maintenance

### Structure Improvements
- **Paragraph unity** (one idea per paragraph)
- **Clear topic sentences** 
- **Logical flow between sections**
- **Proper heading hierarchy**
- **List formatting consistency**

### Content Quality
- **Clarity of technical concepts**
- **Specificity over vague statements** 
- **Evidence-based claims**
- **Complete process steps**

---

## üé® PROCESSING MODES EXPLAINED

### 1. GRAMMAR_CHECK Mode
**Purpose:** Analysis only - identifies problems without making changes

**Use when:** You want to see what's wrong before deciding what to fix

**Output:** Detailed report of issues found with explanations

**Example:**
```
GRAMMAR AND STYLE ANALYSIS
==========================
- Line 15: "Data is processed by the system" - Passive voice, recommend: "The system processes data"  
- Line 23: "We utilize advanced methodologies" - Buzzword "utilize", recommend: "We use proven methods"
- Line 47: Subject-verb disagreement: "The systems works" should be "The system works"
```

### 2. PROOFREAD Mode  
**Purpose:** Creates a fully corrected and refined version

**Use when:** You want Enigma to handle the heavy editing

**Output:** 
- New Word document: `[filename]_PROOFREAD.docx`
- Summary of changes made

### 3. GENERATE_PDF Mode
**Purpose:** Converts Word documents to PDF format

**Methods tried (in order):**
1. LibreOffice command-line conversion (fastest)
2. Python docx2pdf library (reliable)
3. Manual instructions file (fallback)

### 4. FULL_EDIT Mode (Recommended)
**Purpose:** Complete workflow from analysis to final PDF

**Steps performed:**
1. ‚úÖ Read document structure and content  
2. ‚úÖ Analyze grammar, style, and structure
3. ‚úÖ Create proofread version
4. ‚úÖ Generate PDF automatically
5. ‚úÖ Provide comprehensive results summary

---

## üìä REAL EXAMPLE: Product Genome Processing

### Command Used
```bash
python3 scripts/enhanced_document_processor.py --file "03_Projects/Product_Genome/TPG_WorkingFile05012026.docx" --action full_edit
```

### Results Generated
- **Analysis:** Identified 15+ style and grammar issues
- **Proofread File:** `06_Derived/TPG_WorkingFile05012026_PROOFREAD.docx`
- **PDF Version:** `06_Derived/TPG_WorkingFile05012026_PROOFREAD.pdf`

### Key Issues Found and Fixed
- Removed buzzwords like "leverage" and "optimize"  
- Converted passive voice to active voice
- Fixed run-on sentences and comma splices
- Improved paragraph structure and flow
- Enhanced clarity of technical concepts

---

## üõ†Ô∏è TECHNICAL REQUIREMENTS

### Dependencies (Already Installed)
- `python-docx` - Word document reading/writing
- `pymupdf` - PDF reading capability  
- `docx2pdf` - PDF generation from Word docs
- `ollama` - Local LLM for analysis and proofreading

### Model Requirements
- **Recommended:** `qwen3:30b` (when available)
- **Currently tested:** `gemma2:2b` (works well)
- **Fallback:** Any Ollama model with good language capabilities

### System Requirements
- **macOS** (LibreOffice integration optimized for Mac)
- **Python 3.7+** with pip package management
- **Sufficient disk space** in `06_Derived/` for output files

---

## üîß TROUBLESHOOTING

### "LibreOffice not found" Warning
**What it means:** PDF generation fell back to Python method
**Impact:** None - PDF still generated successfully
**Solution (optional):** Install LibreOffice with `brew install libreoffice`

### "Error reading .doc file" 
**What it means:** Legacy Word format needs conversion
**Solution:** Open in Word/Pages and save as .docx format

### "Model not available" Error
**What it means:** Specified Ollama model not installed
**Solution:** Use `--model gemma2:2b` or install preferred model

### Large Document Processing  
**Issue:** Very long documents may hit token limits
**Solution:** Break into chapters or use `grammar_check` mode for sections

---

## üìà RECOMMENDED WORKFLOW

### For New Documents
1. **Write first draft** in Word as usual
2. **Run grammar_check** to see issues: `--action grammar_check`
3. **Fix major structural problems** manually  
4. **Run full_edit** for polished version: `--action full_edit`
5. **Review proofread version** and apply approved changes
6. **Use generated PDF** for final distribution

### For Product Genome Chapters
1. **Place working files** in `03_Projects/Product_Genome/`
2. **Run full_edit workflow** on each chapter  
3. **Review automated improvements** in `06_Derived/`
4. **Integrate best changes** back to originals
5. **Generate final PDFs** for publication

### For Regular Document Maintenance
1. **Set up weekly processing** of important documents
2. **Use grammar_check mode** for quick reviews
3. **Apply full_edit** when ready for external sharing

---

## üéØ NEXT ENHANCEMENTS (Future)

- **Batch processing** of multiple files
- **Custom style guides** for different document types  
- **Version comparison** between original and proofread
- **Integration with file organization** system
- **Automated scheduling** for regular document review

---

## ‚ùì QUICK REFERENCE

**Most common command:**
```bash
python3 scripts/enhanced_document_processor.py --file "path/to/file.docx" --action full_edit
```

**Check what's wrong (safe):**
```bash  
python3 scripts/enhanced_document_processor.py --file "path/to/file.docx" --action grammar_check
```

**Just make PDF:**
```bash
python3 scripts/enhanced_document_processor.py --file "path/to/file.docx" --action generate_pdf  
```

**All outputs go to:** `06_Derived/` directory
**Original files:** Never modified (safe processing)